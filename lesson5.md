


# SQL: Course Introduction & Overview 

# Вступ до курсу Microsoft SQL Server

## Огляд навчальної програми

### 1. Основи SQL
- Основи оператора SELECT
- Використання SELECT DISTINCT
- Операції GROUP BY
- Реалізація підзапитів
- Види операцій JOIN
  - Розуміння різних типів об'єднань
  - Практичне застосування

### 2. Просунутий SQL
- Збережені процедури
- Представлення (Views)
- Загальні табличні вирази (CTE)
- Індексація бази даних
- Просунуті концепції баз даних

### 3. Функції SQL
- Віконні функції
  - Впровадження та практичне використання
- Службові функції
  - Функція COALESCE
  - Функція ISNULL
  - Додаткові функції SQL

### 4. Підготовка до співбесіди
1. Питання з базових концепцій
   - Практичні завдання з основ SQL
   - Розуміння основних концепцій
   - Типові сценарії співбесіди

2. Просунуті питання для співбесіди
   - Складні задачі SQL
   - Реальні питання з співбесід
   - Практичні сценарії розв'язання проблем

### 5. Практичні проекти
1. Інтеграція SQL Server з Power BI
   - Використання Microsoft SQL Server як джерела даних
   - Інтеграція з Power BI
   - Наскрізний робочий процес проекту
   - Повне виконання проекту

## Додаткові можливості
- Постійне оновлення навчальної програми
- Актуальний для індустрії контент
- Матеріали, орієнтовані на співбесіду
- Практичні вправи

## Результати навчання
Після завершення цього курсу студенти зможуть:
- Опанувати основи та просунуті концепції SQL
- Працювати зі складними операціями баз даних
- Інтегрувати SQL Server з Power BI
- Ефективно готуватися до технічних співбесід
- Виконувати наскрізні проекти з аналізу даних

*Примітка: Навчальна програма регулярно оновлюється та вдосконалюється для підтримки актуальності відповідно до вимог галузі та стандартів співбесіди.*

# Вступ до баз даних та SQL

## 1. Що таке база даних?
- Організована колекція даних, що зберігається та доступна електронно
- Цифрова система зберігання, де інформація зберігається структуровано
- Контейнер для збереження необроблених фактів і цифр

### Переваги баз даних:
1. Структуроване зберігання:
   - Дані зберігаються у специфічному форматі (таблиці з рядками та стовпцями)
   - Спрощений процес запитів та аналізу даних

2. Узгодженість:
   - Однотипні дані зберігаються однаково в усій базі даних

3. Цілісність:
   - Забезпечує точність та надійність даних
   - Важливо для прийняття рішень на основі даних

4. Масштабованість:
   - Можливість зростання без проблем з продуктивністю
   - Здатність обробляти великі обсяги даних

## 2. Система управління базами даних (СУБД)
- Програмне забезпечення для створення, управління та взаємодії з базами даних
- Виступає посередником між користувачем і базою даних
- Забезпечує операції: отримання, вставки, оновлення та видалення даних

## 3. Реляційна система управління базами даних (РСУБД)
### Основні характеристики:
- Зберігає дані у структурованому форматі (рядки та стовпці)
- Має зв'язки між таблицями
- Ефективне управління та запити даних

### Ключові елементи:
1. Таблиці:
   - Основна структура зберігання даних
   - Складаються з рядків і стовпців

2. Первинний ключ:
   - Унікальний ідентифікатор для кожного рядка

3. Зовнішній ключ:
   - Встановлює зв'язки між таблицями

4. Нормалізація:
   - Організація даних для мінімізації надлишковості
   - Оптимізація залежностей

## 4. Структурована мова запитів (SQL)
### Визначення:
- Стандартна мова програмування для управління реляційними базами даних
- Використовується для запитів, вставки, оновлення та видалення даних

### Компоненти SQL:
1. DQL (Data Query Language):
   - Мова запитів даних
   - Приклад: оператор SELECT

2. DML (Data Manipulation Language):
   - Мова маніпулювання даними
   - Операції: INSERT, UPDATE, DELETE

3. DDL (Data Definition Language):
   - Мова визначення даних
   - Створення, зміна, видалення структур бази даних

4. DCL (Data Control Language):
   - Мова контролю доступу
   - Надання та відкликання прав доступу

5. TCL (Transaction Control Language):
   - Мова керування транзакціями
   - Операції: COMMIT, ROLLBACK
   - Забезпечення цілісності даних

*Примітка: Цей матеріал є вступним і буде розширено в наступних лекціях курсу.*


# Встановлення Microsoft SQL Server: Покрокова інструкція

## Вибір редакції SQL Server

### Доступні редакції:
1. Developer Edition
   - Повнофункціональна безкоштовна версія
   - Ліцензована для розробки та тестування
   - Призначена для непромислового середовища

2. Express Edition
   - Безкоштовна версія
   - Ідеальна для розробки та впровадження
   - Підходить для настільних, веб- та малих серверних додатків

## Процес встановлення

### 1. Встановлення SQL Server:
- Завантаження Developer Edition
- Запуск виконуваного файлу
- Вибір базового встановлення
- Прийняття умов ліцензії
- Очікування завершення встановлення

### 2. Встановлення SQL Server Management Studio (SSMS):
- Перехід за посиланням для завантаження SSMS
- Запуск установки SSMS
- Очікування завершення встановлення компонентів

## Налаштування з'єднання

### Запуск SSMS:
1. Пошук SQL Server Management Studio в меню Пуск
2. Налаштування підключення:
   - Тип сервера: Database Engine
   - Ім'я сервера: [ім'я вашого комп'ютера]
   - Метод аутентифікації: Windows authentication
   - Шифрування: опціонально

## Перевірка роботи

### Тестування середовища:
1. Відкриття нового вікна запиту
2. Написання простого SQL-запиту:
   ```sql
   SELECT 5 + 5;
   ```
3. Виконання запиту для перевірки результату

### Додаткові налаштування:
- Можливість створення ярлика SSMS на робочому столі
- Налаштування швидкого доступу до середовища

*Примітка: Після успішного встановлення можна починати вивчення Structured Query Language (SQL) та його компонентів.*


# Microsoft SQL Server basics

# SQL SELECT: Основи роботи з запитами

## I. Підготовка середовища

### 1. Налаштування SQL Server Management Studio (SSMS):
- Запуск SSMS
- Підключення до бази даних:
  - Тип сервера: Database Engine
  - Аутентифікація: Windows
  - Налаштування відображення номерів рядків

### 2. Створення бази даних:
```sql
CREATE DATABASE Employee_Details;
USE Employee_Details;
```

## II. Робота з таблицями

### 1. Структура таблиці Employees:
- Employee ID
- First Name
- Last Name
- Department
- Salary
- Hire Date

## III. SELECT запити

### 1. Базовий SELECT:
```sql
SELECT * FROM Employees;
```
- Вибір усіх стовпців та рядків

### 2. Вибір окремих стовпців:
```sql
SELECT FirstName FROM Employees;
SELECT FirstName, Salary FROM Employees;
SELECT FirstName, LastName FROM Employees;
```

### 3. Об'єднання стовпців:
```sql
SELECT 
    EmployeeID,
    CONCAT(FirstName, ' ', LastName) FROM Employees;
```

### 4. Використання псевдонімів (alias):
```sql
SELECT 
    EmployeeID,
    CONCAT(FirstName, ' ', LastName) [Full Name] 
FROM Employees;

-- або

SELECT 
    EmployeeID,
    CONCAT(FirstName, ' ', LastName) AS [Full Name] 
FROM Employees;
```

## IV. Ключові особливості

### 1. Використання CONCAT:
- Об'єднання текстових полів
- Додавання пробілів між значеннями

### 2. Псевдоніми:
- Створення зрозумілих назв стовпців
- Використання ключового слова AS (опціонально)
- Використання квадратних дужок для назв з пробілами

### 3. IntelliSense:
- Автодоповнення назв стовпців
- Підказки при написанні запитів

## V. Практичні поради

### 1. Виконання запитів:
- Використання кнопки Execute
- Гаряча клавіша Ctrl+E
- Вибір конкретного запиту для виконання

### 2. Перегляд результатів:
- Кількість повернених рядків
- Час виконання запиту
- Повідомлення про успішність виконання

*Примітка: Всі приклади коду будуть доступні в ресурсах курсу для практики.*


# SQL DISTINCT: Робота з унікальними значеннями

## I. Підготовка до роботи

### 1. Створення тестової таблиці:
- Назва таблиці: Employee_Records
- Структура:
  - Employee ID
  - First Name
  - Last Name
  - Department
  - Salary

### 2. Базовий перегляд даних:
```sql
SELECT * FROM Employee_Records;
```

## II. Використання DISTINCT

### 1. Вибір унікальних імен:
```sql
SELECT DISTINCT FirstName 
FROM Employee_Records;
```
- Видалення дублікатів імен (наприклад, John, Jane)
- Відображення тільки унікальних значень

### 2. Комбінації унікальних значень:
```sql
SELECT DISTINCT FirstName, LastName 
FROM Employee_Records;
```
- Пошук унікальних комбінацій імен та прізвищ
- Приклади результатів:
  * Emily Davis
  * Jane Smith
  * John Miller
  * Michael Brown

### 3. Унікальні зарплати:
```sql
SELECT DISTINCT Salary 
FROM Employee_Records;
```
- Відображення унікальних значень зарплат
- Усунення повторюваних значень

## III. Особливості DISTINCT

### 1. Робота з усіма стовпцями:
```sql
SELECT DISTINCT * 
FROM Employee_Records;
```
- Пошук унікальних записів за всіма полями
- Врахування відмінностей у Employee ID

### 2. Важливі моменти:
- DISTINCT враховує всі вказані стовпці разом
- Запис вважається унікальним, якщо відрізняється хоча б одне значення
- При використанні * перевіряється унікальність усього запису

## IV. Практичні аспекти

### 1. Виконання запитів:
- Використання Ctrl+E для швидкого виконання
- Перевірка результатів запиту

### 2. Аналіз результатів:
- Порівняння кількості записів до і після DISTINCT
- Перевірка правильності фільтрації

*Примітка: Весь код доступний в ресурсах курсу для практики та подальшого вивчення.*




# Тимчасові таблиці в SQL Server

## І. Вступ до тимчасових таблиць

### 1. Типи існуючих таблиць у базі даних:
- DBO.Employees
- DBO.Employee_Records

## ІІ. Створення тимчасових таблиць

### 1. Тимчасова таблиця з одним #:
```sql
SELECT * INTO #temp1 
FROM dbo.Employees;
```
Особливості:
- Доступна тільки в поточному вікні запиту
- Видаляється після закриття сесії
- Не видима в інших вікнах запиту

### 2. Тимчасова таблиця з двома ##:
```sql
SELECT * INTO ##temp2 
FROM dbo.Employee_Records;
```
Особливості:
- Доступна у всіх вікнах запиту
- Видима в інших сесіях SQL Server
- Існує поки активна оригінальна сесія

## ІІІ. Практичне використання

### 1. Перевірка даних:
```sql
SELECT * FROM #temp1;
SELECT * FROM dbo.Employees;
```
- Порівняння даних оригінальної та тимчасової таблиць
- Перевірка ідентичності структури

### 2. Обмеження доступу:
- Таблиця #temp1:
  * Доступна лише в original query window
  * Помилка при спробі доступу з іншого вікна
- Таблиця ##temp2:
  * Доступна в усіх вікнах
  * Доступна в інших екземплярах SQL Server

## IV. Важливі особливості

### 1. Життєвий цикл:
- Одинарний #:
  * Існує тільки в межах сесії створення
  * Автоматично видаляється після закриття
- Подвійний ##:
  * Існує поки активна створююча сесія
  * Доступна між різними сесіями

### 2. Обмеження:
- Необхідність активної оригінальної сесії
- Автоматичне видалення при закритті сесії
- Різні рівні видимості залежно від типу

*Примітка: У наступних сесіях будуть розглянуті додаткові концепції та питання для інтерв'ю.*


# Використання WHERE в SQL: Фільтрація даних

## І. Основи WHERE

### 1. Базовий синтаксис:
```sql
SELECT * FROM Employee_Records 
WHERE умова;
```

### 2. Приклади фільтрації:
- За ID працівника:
```sql
SELECT * FROM Employee_Records 
WHERE EmployeeID = 2;
```
- За зарплатою:
```sql
SELECT * FROM Employee_Records 
WHERE Salary >= 75000;
```

## II. Комбінація з іншими операторами

### 1. Вибір конкретних стовпців:
```sql
SELECT EmployeeID, FirstName 
FROM Employee_Records 
WHERE EmployeeID = 2;
```

### 2. Використання з DISTINCT:
```sql
SELECT DISTINCT FirstName, LastName, Department, Salary 
FROM Employee_Records 
WHERE Salary < 75000;
```

## III. Оператори порівняння

### 1. Числові порівняння:
- Більше або дорівнює (>=)
- Менше (<)
- Дорівнює (=)

### 2. Приклади використання:
- Зарплата більше 75000:
```sql
SELECT * FROM Employee_Records 
WHERE Salary >= 75000;
```
- Зарплата менше 75000:
```sql
SELECT * FROM Employee_Records 
WHERE Salary < 75000;
```

## IV. Практичні особливості

### 1. Результати фільтрації:
- Відображаються тільки записи, що відповідають умові
- Можливість комбінування з іншими операторами

### 2. Особливості DISTINCT:
- Видалення дублікатів після фільтрації
- Порівняння всіх вибраних стовпців

## V. Корисні поради

### 1. Робота з IntelliSense:
- Автодоповнення назв стовпців
- Підказки при написанні умов

### 2. Перевірка результатів:
- Порівняння результатів з і без DISTINCT
- Перевірка правильності фільтрації

*Примітка: У наступних уроках буде розглянуто складніші запити з використанням WHERE та комбінування з іншими операторами SQL.*


# Використання ORDER BY в SQL: Сортування даних

## І. Підготовка до роботи

### 1. Налаштування середовища:
- Вибір бази даних Employee_Details
- Використання таблиці DBO.Employees
- Перегляд початкових даних

### 2. Базовий перегляд даних:
```sql
SELECT * FROM dbo.Employees;
```

## ІІ. Базове сортування

### 1. Сортування за зростанням:
```sql
SELECT * FROM dbo.Employees 
ORDER BY Salary;
```
- За замовчуванням сортує за зростанням
- Можна явно вказати ASC

### 2. Сортування за спаданням:
```sql
SELECT * FROM dbo.Employees 
ORDER BY Salary DESC;
```
- Використання ключового слова DESC
- Відображення від найбільшого до найменшого

## III. Багатоколонкове сортування

### 1. Комбіноване сортування:
```sql
SELECT * FROM dbo.Employees 
ORDER BY FirstName ASC, Salary DESC;
```
- Спочатку сортування за першим стовпцем
- Потім за другим стовпцем у межах першого

### 2. Приклади комбінацій:
- За відділом та зарплатою:
```sql
SELECT * FROM dbo.Employees 
ORDER BY Department ASC, Salary DESC;
```
Результат показує:
- Спочатку Finance (60,000)
- Потім HR (50,000)
- IT (75,000, 70,000)
- Marketing (55,000)

## IV. Практичні особливості

### 1. Правила сортування:
- ASC можна не вказувати (за замовчуванням)
- DESC потрібно вказувати явно
- Можливість комбінування різних напрямків сортування

### 2. Порядок виконання:
- Сортування виконується послідовно зліва направо
- Кожен наступний стовпець сортується в межах попереднього

*Примітка: ORDER BY - важливий інструмент для організації даних у зручному для аналізу форматі.*

#  Оператори ORDER BY, AND та OR в SQL

## ORDER BY: Додаткові особливості сортування

### Ключові моменти про ORDER BY:
- При сортуванні за зростанням (ASC) ключове слово ASC можна опустити
- При сортуванні за спаданням (DESC) ключове слово DESC обов'язкове
- Можливе сортування за кількома стовпцями одночасно

### Приклад:
```sql
SELECT * FROM employee_records 
ORDER BY department, salary DESC
```
Цей запит відсортує результати:
- Спочатку за департаментом (за зростанням)
- Потім за зарплатою (за спаданням)

## Оператори AND та OR

### Оператор AND
- Використовується для комбінування кількох умов
- Всі умови повинні бути істинними для отримання результату
- Синтаксис:
```sql
SELECT * FROM employee_records 
WHERE last_name = 'Miller' 
AND employee_id = 3
```

### Оператор OR
- Використовується коли достатньо виконання хоча б однієї умови
- Повертає результат, якщо істинна хоча б одна умова
- Приклад:
```sql
SELECT * FROM employee_records 
WHERE department = 'HR' 
OR department = 'Finance'
```

### Комбінування AND та OR
- Можна використовувати обидва оператори в одному запиті
- Важливо правильно групувати умови дужками
- Приклад:
```sql
SELECT * FROM employee_records 
WHERE (department = 'HR' OR department = 'Finance')
AND salary = 60000
```

## Важливі зауваження:
1. При роботі з текстовими значеннями використовуємо одинарні лапки
2. Для числових значень лапки не обов'язкові
3. При комбінуванні операторів важливо використовувати дужки для правильного групування умов
4. Оператор AND має вищий пріоритет ніж OR

## Практичні поради:
- Завжди перевіряйте результати запиту на тестових даних
- Використовуйте відступи та форматування для кращої читабельності запитів
- При складних умовах використовуйте дужки для явного визначення пріоритету операцій

# Оператори NOT, BETWEEN та IN в SQL

## Оператор NOT

### Базове використання NOT
- Використовується для заперечення умови
- Можна застосовувати до різних типів полів (текстових, числових)
- Синтаксис:
```sql
SELECT * FROM employee_records 
WHERE NOT first_name = 'John'
```

### Комбінування NOT з іншими операторами
```sql
SELECT * FROM employee_records 
WHERE NOT first_name = 'John' 
AND NOT salary = 60000
```

### Приклади використання:
- Фільтрація записів, де прізвище не 'Miller'
- Виключення записів з певного відділу
- Комбінування з OR: `WHERE NOT last_name = 'Miller' OR NOT department = 'HR'`

## Оператор BETWEEN

### Основне призначення
- Перевірка чи значення знаходиться в заданому діапазоні
- Включає граничні значення
- Можна використовувати з числами та датами

### Синтаксис:
```sql
SELECT * FROM employee_records 
WHERE salary BETWEEN 75000 AND 85000
```

### Альтернативний запис:
```sql
SELECT * FROM employee_records 
WHERE salary >= 75000 AND salary <= 85000
```

### NOT BETWEEN
- Використовується для значень поза діапазоном
- Два способи запису:
```sql
WHERE salary NOT BETWEEN 75000 AND 85000
WHERE NOT salary BETWEEN 75000 AND 85000
```

## Оператор IN

### Призначення
- Перевірка на входження в список значень
- Заміна multiple OR conditions
- Покращує читабельність коду

### Приклади використання:
```sql
-- Використання IN
SELECT * FROM employee_records 
WHERE department IN ('HR', 'IT')

-- Еквівалентний запис з OR
SELECT * FROM employee_records 
WHERE department = 'HR' OR department = 'IT'
```

### NOT IN
- Виключення значень зі списку
```sql
SELECT * FROM employee_records 
WHERE department NOT IN ('HR', 'IT')
```

## Важливі зауваження

### Регістр символів
- SQL Server нечутливий до регістру для:
  - Ключових слів (SELECT, WHERE, FROM)
  - Імен таблиць
  - Імен стовпців
  - Операторів (BETWEEN, IN, NOT)
- Можна використовувати як верхній, так і нижній регістр

### Практичні поради
1. Використовуйте IN замість множинних OR для кращої читабельності
2. При роботі з діапазонами BETWEEN часто зручніший ніж складні умови
3. Комбінуйте оператори для створення складних умов
4. Завжди перевіряйте результати на тестових даних

# Оператор INSERT INTO в SQL

## Основи INSERT INTO

### Базовий синтаксис
```sql
INSERT INTO dbo.employees (employee_id, first_name, last_name, department, salary, hire_date)
VALUES (6, 'Raj', 'Ambani', 'IT', 67000, '2023-04-20')
```

### Структура оператора:
1. `INSERT INTO` - ключові слова для початку вставки
2. Назва таблиці (наприклад, `dbo.employees`)
3. Список стовпців у дужках
4. Ключове слово `VALUES`
5. Значення у дужках у тому ж порядку, що й стовпці

## Способи вставки даних

### Повна вставка з указанням стовпців
- Вказуємо всі стовпці та їх значення
- Найбільш явний та зрозумілий спосіб
- Приклад:
```sql
INSERT INTO dbo.employees 
(employee_id, first_name, last_name, department, salary, hire_date)
VALUES (6, 'Raj', 'Ambani', 'IT', 67000, '2023-04-20')
```

### Часткова вставка
- Вказуємо лише потрібні стовпці
- Інші стовпці отримують NULL
- Приклад:
```sql
INSERT INTO dbo.employees 
(employee_id, first_name, last_name)
VALUES (7, 'Rohit', 'Meera')
```

### Вставка без указання стовпців
- Потрібно вказати значення для ВСІХ стовпців
- Значення мають бути в правильному порядку
- Приклад:
```sql
INSERT INTO dbo.employees
VALUES (8, 'Mahesh', 'Narang', 'HR', 73000, '2024-01-21')
```

## Важливі особливості

### Типи даних
- Числові значення вводяться без лапок
- Текстові значення в одинарних лапках
- Дати в одинарних лапках у форматі 'YYYY-MM-DD'

### Порядок стовпців
- Для визначення порядку стовпців можна використовувати запит:
```sql
SELECT * FROM information_schema.columns 
WHERE table_name = 'employees'
```
- Колонка `ordinal_position` показує порядок стовпців

### Практичні поради
1. Завжди вказуйте список стовпців для уникнення помилок
2. Перевіряйте типи даних перед вставкою
3. Використовуйте SELECT після INSERT для перевірки
4. При частковій вставці враховуйте NULL-значення

## Помилки, яких слід уникати
1. Невідповідність типів даних
2. Неправильний порядок значень
3. Пропуск обов'язкових полів
4. Неправильне форматування дат
5. Відсутність лапок для текстових даних

# Робота з NULL значеннями в SQL

## Що таке NULL?

### Визначення NULL
- NULL - це спеціальне значення, яке вказує на відсутність даних
- NULL з'являється, коли поле залишається порожнім при створенні запису
- NULL відрізняється від порожнього рядка ('') та нуля (0)

### Приклади різних типів порожніх значень:
```sql
-- Запис з NULL
INSERT INTO dbo.employees 
VALUES (7, 'Rohit', 'Meera', NULL, NULL, NULL);

-- Запис з порожнім рядком
INSERT INTO dbo.employees 
VALUES (9, 'J', '', 'IT', 73000, '2022-04-04');

-- Запис з нулем
INSERT INTO dbo.employees 
VALUES (10, 'Nathan', 'Nathan', '0', 54000, '2021-02-22');
```

## Робота з NULL в запитах

### Перевірка на NULL
- Не можна використовувати звичайні оператори порівняння (=, !=)
- Потрібно використовувати спеціальні оператори IS NULL та IS NOT NULL

### Правильний синтаксис:
```sql
-- Пошук записів з NULL
SELECT * FROM dbo.employees 
WHERE department IS NULL;

-- Пошук записів без NULL
SELECT * FROM dbo.employees 
WHERE department IS NOT NULL;
```

### Неправильний синтаксис:
```sql
-- Це НЕ працюватиме
SELECT * FROM dbo.employees 
WHERE department = NULL;
```

## Важливі особливості

### Відмінності між типами порожніх значень
1. NULL
   - Вказує на відсутність даних
   - Відображається як "NULL" в результатах
   - Потребує спеціальних операторів для порівняння

2. Порожній рядок ('')
   - Є фактичним значенням
   - Відображається як пустий простір
   - Можна порівнювати звичайними операторами

3. Нуль (0)
   - Є конкретним числовим значенням
   - Відображається як "0"
   - Можна використовувати в математичних операціях

### Практичні поради
1. Завжди використовуйте IS NULL замість = NULL
2. Пам'ятайте про різницю між NULL, порожнім рядком та нулем
3. При проектуванні бази даних вирішіть, чи дозволяти NULL значення
4. Використовуйте NULL для позначення відсутніх даних, а не порожні рядки

## Поширені помилки
1. Використання = NULL замість IS NULL
2. Плутанина між NULL та порожнім рядком
3. Спроба виконувати математичні операції з NULL
4. Неправильна обробка NULL у WHERE умовах

#  Оператор UPDATE в SQL

## Базові принципи UPDATE

### Синтаксис UPDATE
```sql
UPDATE назва_таблиці
SET колонка1 = значення1,
    колонка2 = значення2
WHERE умова;
```

### Важливі правила:
1. Завжди використовуйте WHERE умову
2. Перевірте дані SELECT-запитом перед оновленням
3. Спочатку тестуйте на тимчасовій таблиці

## Приклади використання UPDATE

### Оновлення одного стовпця
```sql
-- Заміна NULL значення на 'HR' в стовпці department
UPDATE employees
SET department = 'HR'
WHERE department IS NULL;
```

### Оновлення кількох стовпців
```sql
UPDATE employees
SET salary = 89000,
    hire_date = '2023-01-01'
WHERE employee_id = 7;
```

## Важливі застереження

### Небезпека відсутності WHERE
- Без WHERE умови оновляться ВСІ записи таблиці
- Приклад небезпечного запиту:
```sql
UPDATE employees
SET department = 'Finance'
-- Всі записи будуть змінені!
```

### Безпечні практики
1. Створення тимчасової таблиці для тестування:
```sql
SELECT * INTO #temp 
FROM employees;
```

2. Перевірка даних перед оновленням:
```sql
-- Спочатку перевірте дані
SELECT * FROM employees 
WHERE умова;

-- Потім оновіть
UPDATE employees
SET колонка = значення
WHERE та_сама_умова;
```

## Практичні поради

### Перед оновленням даних:
1. Створіть резервну копію або тимчасову таблицю
2. Перевірте кількість рядків, які будуть оновлені
3. Використовуйте транзакції для важливих оновлень
4. Завжди включайте WHERE умову

### При роботі з виробничою базою даних:
1. Двічі перевірте WHERE умову
2. Спочатку протестуйте на тестовій базі
3. Зробіть резервну копію перед великими змінами
4. Документуйте всі зміни

## Поширені помилки
1. Пропуск WHERE умови
2. Неправильне написання імен стовпців
3. Неправильні типи даних в SET частині
4. Занадто широкі умови в WHERE
5. Відсутність перевірки перед оновленням

# Оператори DELETE, DROP та TRUNCATE в SQL

## Оператор DELETE

### Синтаксис DELETE
```sql
DELETE FROM назва_таблиці
WHERE умова;
```

### Особливості DELETE:
1. Видаляє окремі записи за умовою WHERE
2. Без WHERE видалить усі записи
3. Структура таблиці залишається без змін

### Приклад використання:
```sql
-- Видалення записів за умовою
DELETE FROM employees
WHERE last_name = '' OR department = '0';
```

## Оператор TRUNCATE

### Синтаксис TRUNCATE
```sql
TRUNCATE TABLE назва_таблиці;
```

### Особливості TRUNCATE:
1. Видаляє ВСІ записи з таблиці
2. Структура таблиці залишається
3. Працює швидше ніж DELETE без WHERE
4. Не можна використовувати WHERE

## Оператор DROP

### Синтаксис DROP
```sql
DROP TABLE назва_таблиці;
```

### Особливості DROP:
1. Видаляє всю таблицю повністю
2. Видаляє структуру таблиці
3. Після DROP таблиця перестає існувати
4. Не можна відновити дані простим INSERT

## Порівняння операторів

### DELETE
- Видаляє обрані записи
- Можна використовувати WHERE
- Зберігає структуру таблиці
- Можна відмінити (ROLLBACK)
- Повільніший для видалення всіх даних

### TRUNCATE
- Видаляє всі записи
- Не можна використовувати WHERE
- Зберігає структуру таблиці
- Не можна відмінити (ROLLBACK)
- Швидший за DELETE

### DROP
- Видаляє всю таблицю
- Видаляє структуру таблиці
- Не можна відмінити
- Потребує повторного створення таблиці

## Важливі практичні поради

### Безпечне використання:
1. Завжди використовуйте WHERE з DELETE
2. Робіть резервну копію перед TRUNCATE або DROP
3. Перевіряйте умови DELETE перед виконанням
4. Використовуйте тимчасові таблиці для тестування

### Типові помилки:
1. Забування WHERE в DELETE
2. Використання DROP замість TRUNCATE
3. Невірні умови в WHERE
4. Відсутність резервної копії

## Важливо для співбесід
- Розуміння різниці між операторами
- Знання особливостей кожного оператора
- Вміння пояснити випадки використання
- Розуміння впливу на продуктивність

# Лекція: Коментарі та вибірка TOP записів в SQL

## Коментарі в SQL

### Однорядкові коментарі
- Починаються з двох дефісів (--)
- Діють до кінця рядка
- Приклад:
```sql
-- Це однорядковий коментар
SELECT * FROM employees;
```

### Багаторядкові коментарі
- Починаються з /* та закінчуються */
- Можуть охоплювати кілька рядків
- Приклад:
```sql
/* Це багаторядковий коментар
   Він може займати кілька рядків
   І допомагає пояснити код */
SELECT * FROM employees;
```

### Використання коментарів
- Покращують читабельність коду
- Пояснюють логіку запитів
- Допомагають іншим розробникам
- Можна тимчасово вимкнути частину коду

## Оператор TOP

### Базовий синтаксис
```sql
SELECT TOP n columns
FROM table_name;
```

### Варіанти використання TOP

1. Вибірка всіх стовпців:
```sql
SELECT TOP 2 *
FROM employees;
```

2. Вибірка конкретних стовпців:
```sql
SELECT TOP 4 first_name, last_name
FROM employees;
```

3. Вибірка з умовами:
```sql
SELECT TOP 3 employee_id, salary
FROM employees
WHERE department = 'IT';
```

### Особливості TOP
1. Повертає вказану кількість записів
2. Можна використовувати з будь-якими стовпцями
3. Працює з іншими операторами SQL
4. Корисний для обмеження розміру результату

## Практичні поради

### Коментарі
1. Використовуйте коментарі для документації коду
2. Пишіть зрозумілі та інформативні коментарі
3. Регулярно оновлюйте коментарі при зміні коду
4. Не зловживайте очевидними коментарями

### TOP
1. Використовуйте для обмеження великих наборів даних
2. Комбінуйте з ORDER BY для отримання конкретних записів
3. Враховуйте продуктивність при великих значеннях n
4. Перевіряйте результати на тестових даних

## Поширені помилки
1. Надмірне коментування очевидного коду
2. Застарілі коментарі, що не відповідають коду
3. Використання TOP без ORDER BY, коли порядок важливий
4. Неврахування впливу TOP на продуктивність запиту


#  Агрегатні функції SQL - MAX та GROUP BY

## Функція MAX

### Основи використання MAX
- Знаходить максимальне значення в стовпці
- Працює з різними типами даних
- Ігнорує NULL значення
- Можна використовувати псевдоніми для результатів

### Приклади використання MAX:

1. З числовими даними:
```sql
SELECT MAX(total_amount) AS [Maximum Amount]
FROM dbo.sales;
```

2. З датами:
```sql
SELECT MAX(sale_date) AS [Max Sale Date]
FROM dbo.sales;
```

3. З текстовими даними:
```sql
SELECT MAX(payment_method) AS [Max Payment Method]
FROM dbo.sales;
```

## Оператор GROUP BY

### Призначення GROUP BY
- Групує дані за вказаними стовпцями 
- Дозволяє застосовувати агрегатні функції до груп
- Обов'язковий при комбінуванні агрегатних і неагрегатних стовпців

### Правила використання:
1. Всі неагреговані стовпці в SELECT повинні бути в GROUP BY
2. GROUP BY пишеться після WHERE, але перед ORDER BY
3. Можна групувати за кількома стовпцями

### Приклади GROUP BY:

1. Максимальна кількість за продуктами:
```sql
SELECT product_id,
       MAX(quantity) AS [Maximum Quantity]
FROM dbo.sales
GROUP BY product_id;
```

2. Максимальна сума продажів за датами:
```sql
SELECT sale_date,
       MAX(total_amount) AS [Maximum Total Amount]
FROM dbo.sales
GROUP BY sale_date;
```

## Важливі особливості

### Робота з NULL значеннями
- MAX ігнорує NULL при обчисленнях
- NULL не впливає на результат
- При групуванні NULL утворює окрему групу

### Використання псевдонімів
- Рекомендується давати зрозумілі назви результатам
- Використовуйте квадратні дужки для назв з пробілами
- Псевдоніми покращують читабельність результатів

## Практичні поради

### При використанні MAX:
1. Перевіряйте тип даних стовпця
2. Враховуйте наявність NULL значень
3. Використовуйте зрозумілі псевдоніми
4. Перевіряйте результати на тестових даних

### При використанні GROUP BY:
1. Перевіряйте всі неагреговані стовпці
2. Плануйте групування заздалегідь
3. Використовуйте HAVING для фільтрації груп
4. Перевіряйте кількість отриманих груп



# Функція MIN в SQL

## Основи функції MIN

### Загальний синтаксис
```sql
SELECT MIN(column_name) AS [Alias]
FROM table_name;
```

### Використання з різними типами даних

1. Числові дані:
```sql
SELECT MIN(quantity) AS [Minimum Quantity]
FROM dbo.sales;
```

2. Дати:
```sql
SELECT MIN(sale_date) AS [Minimum Sale Date]
FROM dbo.sales;
```

3. Текстові дані:
```sql
SELECT MIN(payment_method) AS [Minimum Payment Method]
FROM dbo.sales;
```

## Особливості роботи MIN

### Обробка NULL значень
- MIN ігнорує NULL значення
- NULL не враховуються при пошуку мінімуму
- Результат повертається на основі непорожніх значень

### Псевдоніми (Аліаси)
- Рекомендується використовувати для зрозумілих назв
- Записуються в квадратних дужках `[Назва]`
- Покращують читабельність результатів

## MIN з GROUP BY

### Синтаксис
```sql
SELECT column_name,
       MIN(aggregated_column) AS [Alias]
FROM table_name
GROUP BY column_name;
```

### Приклад використання
```sql
SELECT store_id,
       MIN(total_amount) AS [Minimum Total Amount]
FROM dbo.sales
GROUP BY store_id;
```

### Правила групування
1. Неагреговані стовпці в SELECT повинні бути в GROUP BY
2. Агреговані стовпці (з MIN) не потребують GROUP BY
3. GROUP BY може містити кілька стовпців

## Практичні приклади

### Мінімальна сума продажів за магазинами
```sql
SELECT store_id,
       MIN(total_amount) AS [Minimum Total Amount]
FROM dbo.sales
GROUP BY store_id;
```

### Результат покаже:
- Мінімальну суму продажів для кожного магазину
- Усі унікальні store_id
- Згруповані результати за магазинами

## Важливі моменти

### При використанні MIN:
1. Перевіряйте тип даних стовпця
2. Враховуйте наявність NULL значень
3. Використовуйте зрозумілі псевдоніми
4. Перевіряйте результати на тестових даних

### При використанні з GROUP BY:
1. Правильно визначайте стовпці для групування
2. Перевіряйте всі неагреговані стовпці
3. Використовуйте HAVING для фільтрації груп
4. Перевіряйте очікувану кількість груп


# Агрегатні функції SQL - SUM, AVG та COUNT

## Функція SUM

### Призначення та синтаксис
```sql
SELECT SUM(column_name) AS [Alias]
FROM table_name;
```

### Приклади використання
```sql
-- Сума одного стовпця
SELECT SUM(quantity) AS [Total Quantity]
FROM dbo.sales;

-- Сума кількох стовпців
SELECT SUM(quantity) AS [Total Quantity],
       SUM(total_amount) AS [Sum of Amount]
FROM dbo.sales;
```

## Функція AVG (AVERAGE)

### Базовий синтаксис
```sql
SELECT AVG(column_name) AS [Alias]
FROM table_name;
```

### Приклади використання
```sql
-- Середнє значення для одного стовпця
SELECT AVG(quantity) AS [Average Quantity]
FROM dbo.sales;

-- Середнє для кількох стовпців
SELECT AVG(quantity) AS [Avg Quantity],
       AVG(total_amount) AS [Avg Amount]
FROM dbo.sales;
```

## Функція COUNT

### Варіанти синтаксису
```sql
-- Підрахунок всіх рядків
SELECT COUNT(*) AS [Number of Rows]
FROM table_name;

-- Підрахунок значень у стовпці (без NULL)
SELECT COUNT(column_name) AS [Count]
FROM table_name;

-- Підрахунок унікальних значень
SELECT COUNT(DISTINCT column_name) AS [Distinct Count]
FROM table_name;
```

### Особливості COUNT
1. COUNT(*) враховує всі рядки, включаючи NULL
2. COUNT(column) ігнорує NULL значення
3. COUNT(DISTINCT) рахує унікальні значення

## Використання з GROUP BY

### Загальний синтаксис
```sql
SELECT column_name,
       SUM(value_column) AS [Total],
       AVG(value_column) AS [Average],
       COUNT(*) AS [Count]
FROM table_name
GROUP BY column_name;
```

### Правила групування
1. Неагреговані стовпці в SELECT повинні бути в GROUP BY
2. Можна групувати за кількома стовпцями
3. Агреговані стовпці не потребують GROUP BY

## Особливості роботи з NULL

### Для всіх агрегатних функцій:
1. SUM ігнорує NULL значення
2. AVG ігнорує NULL при обчисленні середнього
3. COUNT(*) включає рядки з NULL
4. COUNT(column) ігнорує NULL
5. COUNT(DISTINCT) не враховує NULL як окреме значення

## Практичні приклади

### Комбінування функцій з GROUP BY
```sql
SELECT product_id,
       store_id,
       SUM(quantity) AS [Total Quantity],
       AVG(total_amount) AS [Average Amount],
       COUNT(*) AS [Number of Sales]
FROM dbo.sales
GROUP BY product_id, store_id;
```

## Поради щодо використання

### При роботі з агрегатними функціями:
1. Завжди використовуйте інформативні aliases
2. Перевіряйте наявність NULL значень
3. Вибирайте правильний тип COUNT
4. Переконайтеся, що GROUP BY включає всі необхідні стовпці





